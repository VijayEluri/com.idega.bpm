<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:idega="http://idega.com/xforms" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <head>
        <title>
            <xf:output model="data_model" ref="instance('localized_strings')/form.title[@lang=instance('localized_strings')/current_language]"/>
        </title>
        <xf:model id="submission_model" schema="#fb-schema">
            <xf:instance xmlns="" id="data-instance">
                <data>
                    <form_id>704</form_id>
                    <readonlyHideButton/>
                    <Address_fbc_10 mapping="string_ownerAddress"/>
                    <Postal_code_fbc_11 mapping="string_ownerPostalCode"/>
                    <City_fbc_12 mapping="string_ownerMunicipality"/>
                    <Name_fbc_13 mapping="string_ownerFullName"/>
                    <Personal_id_fbc_14 mapping="string_ownerPersonalId" xsi:nil="true"/>
                    <Matching_emails_2_fbc_15 xsi:nil="true"/>
                    <Matching_emails_1_fbc_16 mapping="string_ownerEmailAddress" xsi:nil="true"/>
                </data>
            </xf:instance>
            <xf:instance id="control-instance">
                <control xmlns="">
                    <enable>true</enable>
                    <required>true</required>
                    <readonly>false</readonly>
                    <validation>true</validation>
                    <submission>false</submission>
                </control>
            </xf:instance>
            <xf:submission action="xformsBPM:/nouri" id="submit_data_submission" method="post" replace="none">
                <xf:toggle case="fbc_4" ev:event="xforms-submit-done"/>
            </xf:submission>
            <xf:action ev:event="xforms-submit-error" id="submission-error">
                <xf:message level="modeless" ref="instance('localized_strings')/page-1-error.label[@lang=instance('localized_strings')/current_language]"/>
            </xf:action>
            <xf:bind id="bind.readonlyHideButton" nodeset="readonlyHideButton" relevant="instance('control-instance')/readonly != 'true'"/>
            <xf:bind id="bind.fbc_10" nodeset="Address_fbc_10" type="xs:string"/>
            <xf:instance id="fbc_10_autofill-instance" relevant="false()" src="context:fb-afk-loginSession.user.usersMainAddress.streetAddress"/>
            <xf:bind id="bind.fbc_11" nodeset="Postal_code_fbc_11" type="xs:string"/>
            <xf:instance id="fbc_11_autofill-instance" relevant="false()" src="context:fb-afk-loginSession.user.usersMainAddress.postalCode.postalCode"/>
            <xf:bind id="bind.fbc_12" nodeset="City_fbc_12" type="xs:string"/>
            <xf:instance id="fbc_12_autofill-instance" relevant="false()" src="context:fb-afk-loginSession.user.usersMainAddress.city"/>
            <xf:bind id="bind.fbc_13" nodeset="Name_fbc_13" required="not(instance('control-instance')/required = 'false')" type="xs:string"/>
            <xf:instance id="fbc_13_autofill-instance" relevant="false()" src="context:fb-afk-loginSession.user.name"/>
            <xf:bind id="bind.fbc_14" nodeset="Personal_id_fbc_14" required="not(instance('control-instance')/required = 'false')" type="xs:integer"/>
            <xf:instance id="fbc_14_autofill-instance" relevant="false()" src="context:fb-afk-loginSession.user.personalID"/>
            <xf:bind id="bind.fbc_15" nodeset="Matching_emails_2_fbc_15" required="not(instance('control-instance')/required = 'false')" type="fbc_15fb_email"/>
            <xf:bind id="bind.fbc_16" nodeset="Matching_emails_1_fbc_16" required="not(instance('control-instance')/required = 'false')" type="fbc_16fb_email"/>
        </xf:model>
        <xf:model id="data_model">
            <xf:instance xmlns="" id="localized_strings">
                <localized_strings>
                    <default_language>en</default_language>
                    <current_language>en</current_language>
                    <page-1-error.label lang="en">Submission error. Please check your form!</page-1-error.label>
                    <page-1-error.label lang="is_IS">Submission error. Please check your form!</page-1-error.label>
                    <form.title lang="en">New user registration</form.title>
                    <page-1.label lang="en">First section</page-1.label>
                    <page-1.label lang="is_IS">First section</page-1.label>
                    <page-2.label lang="en">Submitted</page-2.label>
                    <page-2.label lang="is_IS">Sent</page-2.label>
                    <page-1-submit.label lang="en">Submit</page-1-submit.label>
                    <page-1-submit.label lang="is_IS">Submit</page-1-submit.label>
                    <page-2.info lang="en">Form submitted, thank You!</page-2.info>
                    <page-2.info lang="is_IS">Form submitted, thank You!</page-2.info>
                    <form.title lang="is_IS">Title</form.title>
                    <fbc_8.error lang="is_IS">Invalid email</fbc_8.error>
                    <fbc_8.error lang="en">Invalid email</fbc_8.error>
                    <fbc_10.title lang="is_IS">Heimilisfang</fbc_10.title>
                    <fbc_10.title lang="en">Address</fbc_10.title>
                    <fbc_11.title lang="is_IS">Póstnúmer</fbc_11.title>
                    <fbc_11.title lang="en">Postal code</fbc_11.title>
                    <fbc_12.title lang="is_IS">City</fbc_12.title>
                    <fbc_12.title lang="en">City</fbc_12.title>
                    <fbc_13.title lang="is_IS">Nafn</fbc_13.title>
                    <fbc_13.title lang="en">Name</fbc_13.title>
                    <fbc_13.required lang="is_IS">Nafn verður að vera útfyllt</fbc_13.required>
                    <fbc_13.required lang="en">Name can not be empty</fbc_13.required>
                    <fbc_14.title lang="is_IS">Kennitala</fbc_14.title>
                    <fbc_14.title lang="en">Social security number</fbc_14.title>
                    <fbc_14.validation lang="is_IS">Kennitala má bara innihalda tölur</fbc_14.validation>
                    <fbc_14.validation lang="en">Social security should be a number</fbc_14.validation>
                    <fbc_14.required lang="is_IS">Kennitala þarf að vera útfyllt</fbc_14.required>
                    <fbc_14.required lang="en">Social security number can not be empty</fbc_14.required>
                    <fbc_14.exists lang="is_IS">Account already exists with this personal id</fbc_14.exists>
                    <fbc_14.exists lang="en">Account already exists with this personal id</fbc_14.exists>
                    <fbc_15.title lang="is_IS">Email</fbc_15.title>
                    <fbc_15.title lang="en">Matching emails 2</fbc_15.title>
                    <fbc_16.title lang="is_IS">Email</fbc_16.title>
                    <fbc_16.title lang="en">Matching emails 1</fbc_16.title>
                    <fbc_16.required lang="is_IS">Email is required</fbc_16.required>
                    <fbc_16.required lang="en">Email is required</fbc_16.required>
                    <fbc_15.required lang="is_IS">Email is required</fbc_15.required>
                    <fbc_15.required lang="en">Email is required</fbc_15.required>
                    <fbc_15.validation lang="is_IS">Email is incorrect</fbc_15.validation>
                    <fbc_15.validation lang="en">Email is incorrect</fbc_15.validation>
                    <fbc_16.validation lang="is_IS">Email is incorrect</fbc_16.validation>
                    <fbc_16.validation lang="en">Email is incorrect</fbc_16.validation>
                    <fbc_16.custom lang="en">Emails must match</fbc_16.custom>
                    <fbc_16.custom lang="is_IS">Emails must match</fbc_16.custom>
                </localized_strings>
            </xf:instance>
            <xf:bind id="errorsGroup" nodeset="instance('error-instance')/error" relevant="idega:instance('submission_model', 'control-instance')/submission = 'true'"/>
            <xf:bind id="errors" nodeset="instance('error-instance')/error[. != '']"/>
            <xf:instance xmlns="" id="error-instance">
                <data>
                    <error for=""/>
                </data>
            </xf:instance>
            <xf:instance id="locale-instance" relevant="false()" src="context:fb-afk-loginSession.currentLocale"/>
            <xf:action ev:event="xforms-ready">
                <idega:dispatch name="idega-xforms-ready" target="//h:body//*[starts-with(@id, 'fbc_')]"/>
                <xf:setvalue model="data_model" ref="instance('localized_strings')/current_language" value="instance('locale-instance')/fb-afk-loginSession.currentLocale"/>
            </xf:action>
        </xf:model>
        <xs:schema id="fb-schema">
            <xs:simpleType name="fbc_8fb_email">
                <xs:restriction base="xs:string">
                    <xs:pattern value="[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*@[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*"/>
                </xs:restriction>
            </xs:simpleType>
            <xs:simpleType name="fbc_9fb_email">
                <xs:restriction base="xs:string">
                    <xs:pattern value="[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*@[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*"/>
                </xs:restriction>
            </xs:simpleType>
            <xs:simpleType name="fbc_15fb_email">
                <xs:restriction base="xs:string">
                    <xs:pattern value="[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*@[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*"/>
                </xs:restriction>
            </xs:simpleType>
            <xs:simpleType name="fbc_16fb_email">
                <xs:restriction base="xs:string">
                    <xs:pattern value="[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*@[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+(\.[A-Za-z0-9!#-'\*\+\-/=\?\^_`\{-~]+)*"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:schema>
        <xf:model id="x-autofill-model">
            <xf:action ev:event="xforms-ready">
                <xf:setvalue bind="bind.fbc_10" id="fbc_10-autofill-setvalue" model="submission_model" value="instance('fbc_10_autofill-instance')/fb-afk-loginSession.user.usersMainAddress.streetAddress"/>
                <xf:setvalue bind="bind.fbc_11" id="fbc_11-autofill-setvalue" model="submission_model" value="instance('fbc_11_autofill-instance')/fb-afk-loginSession.user.usersMainAddress.postalCode.postalCode"/>
                <xf:setvalue bind="bind.fbc_12" id="fbc_12-autofill-setvalue" model="submission_model" value="instance('fbc_12_autofill-instance')/fb-afk-loginSession.user.usersMainAddress.city"/>
                <xf:setvalue bind="bind.fbc_13" id="fbc_13-autofill-setvalue" model="submission_model" value="instance('fbc_13_autofill-instance')/fb-afk-loginSession.user.name"/>
                <xf:setvalue bind="bind.fbc_14" id="fbc_14-autofill-setvalue" model="submission_model" value="instance('fbc_14_autofill-instance')/fb-afk-loginSession.user.personalID"/>
            </xf:action>
        </xf:model>
    </head>
    <body>
        <xf:group appearance="full">
            <xf:group bind="errorsGroup" class="xformErrors">
                <xf:repeat bind="errors">
                    <xf:output ref="."/>
                </xf:repeat>
            </xf:group>
            <idega:setError ev:event="idega-validation-error" ref="instance('error-instance')/error"/>
            <xf:switch>
                <xf:case id="fbc_1">
                    <xf:group appearance="full">
                        <xf:label model="data_model" ref="instance('localized_strings')/page-1.label[@lang=instance('localized_strings')/current_language]"/>
                        <xf:input bind="bind.fbc_13" id="fbc_13">
                            <xf:label model="data_model" ref="instance('localized_strings')/fbc_13.title[@lang=instance('localized_strings')/current_language]"/>
                            <xf:dispatch ev:event="idega-xforms-ready" name="idega-validate" target="fbc_13"/>
                            <xf:dispatch ev:event="xforms-value-changed" name="idega-validate" target="fbc_13"/>
                            <idega:validator ev:event="idega-validate">
                                <idega:message errorType="required" model="data_model" value="instance('localized_strings')/fbc_13.required[@lang=instance('localized_strings')/current_language]"/>
                            </idega:validator>
                            <xf:alert ref="instance('error-instance')/error[@for='fbc_13']"/>
                        </xf:input>
                        <xf:input bind="bind.fbc_14" id="fbc_14">
                            <xf:label model="data_model" ref="instance('localized_strings')/fbc_14.title[@lang=instance('localized_strings')/current_language]"/>
                            <xf:dispatch ev:event="idega-xforms-ready" name="idega-validate" target="fbc_14"/>
                            <xf:dispatch ev:event="xforms-value-changed" name="idega-validate" target="fbc_14"/>
                            <idega:validator ev:event="idega-validate" validateif="not(idega:userNameAlreadyExists(instance('data-instance')/Personal_id_fbc_14))">
                                <idega:message errorType="required" model="data_model" value="instance('localized_strings')/fbc_14.required[@lang=instance('localized_strings')/current_language]"/>
                                <idega:message errorType="validation" model="data_model" value="instance('localized_strings')/fbc_14.validation[@lang=instance('localized_strings')/current_language]"/>
                                <idega:message errorType="custom" model="data_model" value="instance('localized_strings')/fbc_14.exists[@lang=instance('localized_strings')/current_language]"/>
                            </idega:validator>
                            <xf:alert ref="instance('error-instance')/error[@for='fbc_14']"/>
                        </xf:input>
                        <xf:group>
                            <xf:input bind="bind.fbc_16" id="fbc_16">
                                <xf:label model="data_model" ref="instance('localized_strings')/fbc_16.title[@lang=instance('localized_strings')/current_language]"/>
                                <xf:alert ref="instance('error-instance')/error[@for='fbc_16']"/>
                                <xf:dispatch ev:event="idega-xforms-ready" name="idega-validate" target="fbc_16"/>
                                <xf:action ev:event="xforms-value-changed">
                                    <xf:dispatch name="idega-validate" target="fbc_16"/>
                                    <xf:dispatch name="idega-validate" target="fbc_15"/>
                                </xf:action>
                                <idega:validator ev:event="idega-validate" validateif="instance('data-instance')/Matching_emails_2_fbc_15 = instance('data-instance')/Matching_emails_1_fbc_16">
                                    <idega:message errorType="required" model="data_model" value="instance('localized_strings')/fbc_16.required[@lang=instance('localized_strings')/current_language]"/>
                                    <idega:message errorType="validation" model="data_model" value="instance('localized_strings')/fbc_16.validation[@lang=instance('localized_strings')/current_language]"/>
                                    <idega:message errorType="custom" model="data_model" value="instance('localized_strings')/fbc_16.custom[@lang=instance('localized_strings')/current_language]"/>
                                </idega:validator>
                            </xf:input>
                            <xf:input bind="bind.fbc_15" id="fbc_15">
                                <xf:label model="data_model" ref="instance('localized_strings')/fbc_15.title[@lang=instance('localized_strings')/current_language]"/>
                                <xf:alert ref="instance('error-instance')/error[@for='fbc_15']"/>
                                <xf:dispatch ev:event="idega-xforms-ready" name="idega-validate" target="fbc_15"/>
                                <xf:action ev:event="xforms-value-changed">
                                    <xf:dispatch name="idega-validate" target="fbc_16"/>
                                    <xf:dispatch name="idega-validate" target="fbc_15"/>
                                </xf:action>
                                <idega:validator ev:event="idega-validate">
                                    <idega:message errorType="required" model="data_model" value="instance('localized_strings')/fbc_15.required[@lang=instance('localized_strings')/current_language]"/>
                                    <idega:message errorType="validation" model="data_model" value="instance('localized_strings')/fbc_15.validation[@lang=instance('localized_strings')/current_language]"/>
                                </idega:validator>
                            </xf:input>
                        </xf:group>
                        <xf:input bind="bind.fbc_10" id="fbc_10">
                            <xf:label model="data_model" ref="instance('localized_strings')/fbc_10.title[@lang=instance('localized_strings')/current_language]"/>
                        </xf:input>
                        <xf:input bind="bind.fbc_11" id="fbc_11">
                            <xf:label model="data_model" ref="instance('localized_strings')/fbc_11.title[@lang=instance('localized_strings')/current_language]"/>
                        </xf:input>
                        <xf:input bind="bind.fbc_12" id="fbc_12">
                            <xf:label model="data_model" ref="instance('localized_strings')/fbc_12.title[@lang=instance('localized_strings')/current_language]"/>
                        </xf:input>
                        <div class="fbc_button_area" id="fbc_2" name="fbc_button_area">
                            <xf:trigger bind="bind.readonlyHideButton" class="fbc_button_submit" id="fbc_3" name="fbc_button_submit">
                                <xf:label model="data_model" ref="instance('localized_strings')/page-1-submit.label[@lang=instance('localized_strings')/current_language]"/>
                                <xf:action ev:event="DOMActivate">
                                    <xf:setvalue ref="instance('control-instance')/submission" value="'true'"/>
                                    <idega:dispatch name="idega-validate" target="//h:body//*[starts-with(@id, 'fbc_')]"/>
                                    <xf:dispatch name="xforms-rebuild" target="data_model"/>
                                    <xf:dispatch name="xforms-recalculate" target="data_model"/>
                                    <xf:dispatch name="xforms-revalidate" target="data_model"/>
                                    <xf:dispatch name="xforms-refresh" target="data_model"/>
                                    <xf:action if="count-non-empty(instance('error-instance')/error)=0">
                                    <xf:setvalue ref="instance('control-instance')/validation" value="'false'"/>
                                    <xf:send submission="submit_data_submission"/>
                                    </xf:action>
                                </xf:action>
                            </xf:trigger>
                        </div>
                    </xf:group>
                </xf:case>
                <xf:case id="fbc_4" name="thx_page">
                    <xf:group appearance="full">
                        <xf:label model="data_model" ref="instance('localized_strings')/page-2.label[@lang=instance('localized_strings')/current_language]"/>
                        <xf:output model="data_model" ref="instance('localized_strings')/page-2.info[@lang=instance('localized_strings')/current_language]"/>
                    </xf:group>
                </xf:case>
            </xf:switch>
        </xf:group>
    </body>
</html>

<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:idega="http://idega.com/xforms" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <head>
        <title>
         <xf:output model="data_model" ref="instance('localized_strings')/form-title[@lang=instance('localized_strings')/current_language]"/>
      </title>

        <xf:model id="submission_model" schema="#fb-schema">
            <xf:instance xmlns="" id="data-instance">
                <data>
                    <form_id>1842</form_id>
               <Subject_fbc_5 mapping="string_subject"/>
               <Text_fbc_6 mapping="string_text"/>
            <Paragraph_text_input_fbc_5 mapping="string_description"/>
<Attachements_fbc_6 mapping="files_attachments">
               <group/>
               <entry filename="" mediatype="">
                    <description/>
               </entry>         
               <entry filename="" mediatype="">
                    <description/>
               </entry>
            </Attachements_fbc_6>
</data>
            </xf:instance>   
            
             <xf:instance id="control-instance">
                <control xmlns="">
                    <readonly>false</readonly>
                    <submission>false</submission>
                      <generatePdf>false</generatePdf>
                <submissionButton/>
</control>
            </xf:instance>
                     
          
             <xf:submission action="xformsBPM:/nouri" id="submit_data_submission" method="post" ref="instance('data-instance')" replace="none">
                <idega:toggle case="fbc_4" ev:event="xforms-submit-done"/>
            </xf:submission>
            
             <xf:action ev:event="xforms-submit-error" id="submission-error">
                <xf:dispatch name="idega-submit-error" target="idega-submission-error"/>
            </xf:action>
            <xf:action ev:event="idega-submit-error" id="idega-submission-error">
                <xf:message level="modeless" ref="instance('localized_strings')/submission-error_message[@lang=instance('localized_strings')/current_language]"/>
            </xf:action>
    
      <xf:bind id="fbc_5_bind" nodeset="Paragraph_text_input_fbc_5" readonly="instance('control-instance')/readonly = 'true'" type="xs:string"/>
<xf:bind id="fbc_6_bind" nodeset="Attachements_fbc_6/group" relevant="instance('control-instance')/readonly != 'true' and instance('control-instance')/generatePdf != 'true'">
        <xf:bind id="fbc_6_bind-entries" nodeset="../entry[position() != last()]" type="xs:anyURI"/>
    </xf:bind>
<xf:bind id="bind-submissionButton" idega:shared="true" nodeset="instance('control-instance')/submissionButton" relevant="instance('control-instance')/readonly != 'true' and instance('control-instance')/generatePdf != 'true'"/>

 <xf:bind id="errorsGroup" idega:shared="true" nodeset="instance('error-instance')/error" relevant="instance('control-instance')/submission = 'true' and count-non-empty(instance('error-instance')/error)!=0"/>
            <xf:bind id="errors" idega:shared="true" nodeset="instance('error-instance')/error[. != '']"/>
            <xf:instance xmlns="" id="error-instance">
                <data>
                    <error for=""/>
                    <sendLinkError for=""/>
                </data>
            </xf:instance>
            
</xf:model>
        <xf:model id="data_model">
            <xf:instance xmlns="" id="localized_strings">
                  <localized_strings>
                        <default_language>en</default_language>
                       <current_language>is_IS</current_language>
                       
                       <form-title lang="en">Attachment</form-title>
                         <form-title lang="is_IS">Attachment</form-title>
                         
                     
                           
                       <page-2-label lang="en">Submitted</page-2-label>
                      <page-2-label lang="is_IS">Submitted</page-2-label>
                      
                       <page-2-info lang="en">Form submitted, thank You!</page-2-info>
                         <page-2-info lang="is_IS">Form submitted, thank You!</page-2-info>
                       
                <submission-error_message lang="en">Submission error. Please check your form!</submission-error_message>
                    <submission-error_message lang="is_IS">Villa varð við að senda formið vinsamlegast athugið hvort stjörnumerktir reitir hafi allir verið útfylltir og að engar villur séu í forminu.</submission-error_message>
                 
               
            	<fbc_5-label lang="is_IS">Málsgrein</fbc_5-label>
				<fbc_5-label lang="en">Paragraph text input</fbc_5-label>
				<fbc_6-title lang="is_IS">Viðhengi</fbc_6-title>
				<fbc_6-title lang="en">Attachements</fbc_6-title>
				<fbc_6-insert_trigger-label lang="is_IS">Bæta við viðhengi</fbc_6-insert_trigger-label>
				<fbc_6-insert_trigger-label lang="en">Add attachement</fbc_6-insert_trigger-label>
				<fbc_6-description-label lang="is_IS">Lýsandi</fbc_6-description-label>
				<fbc_6-description-label lang="en">Description</fbc_6-description-label>
				<fbc_6-filename-label lang="is_IS">Skráarnafn</fbc_6-filename-label>
				<fbc_6-filename-label lang="en">Uploaded file name</fbc_6-filename-label>
				<fbc_6-custom lang="is_IS">Það þarf að setja lýsandi nafn á skjalið</fbc_6-custom>
				<fbc_6-custom lang="en">Uploaded file description can not be empty</fbc_6-custom>
				<fbc_6-remove_trigger-label lang="is_IS">Fjarlægja viðhengi</fbc_6-remove_trigger-label>
				<fbc_6-remove_trigger-label lang="en">Remove</fbc_6-remove_trigger-label>
				<fbc_6-paragraph-text lang="is_IS">Mögulegt er að senda viðbótarupplýsingar í viðhengi</fbc_6-paragraph-text>
            	<fbc_6-paragraph-text lang="en">Additional information can be sent with the form as attachments</fbc_6-paragraph-text>
        
				<fbc_8-label lang="is_IS">Senda</fbc_8-label>
				<fbc_8-label lang="en">Submit</fbc_8-label>
</localized_strings>
            </xf:instance>
            
            <xf:instance id="locale-instance" relevant="false()" src="context:fb-afk-loginSession.currentLocale"/>
             
 <xf:action ev:event="xforms-ready">
                <xf:setvalue model="data_model" ref="instance('localized_strings')/current_language" value="instance('locale-instance')/fb-afk-loginSession.currentLocale"/>
    </xf:action>
            
          </xf:model>
        <xs:schema id="fb-schema">
        </xs:schema>
    </head>
    <body>
        <xf:group appearance="full">
         <xf:group bind="errorsGroup" class="xformErrors">
                <xf:repeat bind="errors">
                    <xf:output ref="."/>
                </xf:repeat>
            </xf:group>
            <idega:setError ev:event="idega-validation-error" id="formSetErrorHandler" if="idega:instance('submission_model', 'saveForm-instance')/savePhase != 'true'" ref="instance('error-instance')/error"/>
           
        
            <idega:switch>
                  <idega:case id="fbc_1" show="instance('control-instance')/generatePdf='true'">
                        <xf:group appearance="full">
                  
                        <xf:textarea bind="fbc_5_bind" id="fbc_5">
<xf:label model="data_model" ref="instance('localized_strings')/fbc_5-label[@lang=instance('localized_strings')/current_language]"/>
</xf:textarea>



<xf:group appearance="full" bind="fbc_6_bind" id="fbc_6" type="fbc_multiupload">
<idega:dispatch ev:event="idega-xforms-ready" name="idega-validate" stopOnError="true" target="//*[@id='fbc_6']//xf:upload"/>

 

<xf:label model="data_model" ref="instance('localized_strings')/fbc_6-title[@lang=instance('localized_strings')/current_language]"/>

 <div class="fbc_simple_text">
					<xf:output model="data_model" ref="instance('localized_strings')/fbc_6-paragraph-text[@lang=instance('localized_strings')/current_language]"/>
				</div>	
<xf:trigger>
<xf:label model="data_model" ref="instance('localized_strings')/fbc_6-insert_trigger-label[@lang=instance('localized_strings')/current_language]"/>
<xf:action>
<xf:insert at="last()" nodeset="instance('data-instance')/Attachements_fbc_6/entry" position="before"/>
</xf:action>
</xf:trigger>
<xf:repeat appearance="group" bind="fbc_6_bind-entries" id="fbc_6-multiupload_entries">
<xf:group>
<xf:input ref="./description">
<xf:label model="data_model" ref="instance('localized_strings')/fbc_6-description-label[@lang=instance('localized_strings')/current_language]"/>
<idega:dispatch ev:event="xforms-value-changed" name="idega-validate" stopOnError="true" target="//*[@id='fbc_6']//xf:upload"/>
</xf:input>
<xf:group appearance="minimal" class="error" ref=".[. !='' and ./description ='']">
<xf:output value="instance('error-instance')/error[@for='fbc_6']"/>
</xf:group>
<xf:output ref="@filename">
<xf:label model="data_model" ref="instance('localized_strings')/fbc_6-filename-label[@lang=instance('localized_strings')/current_language]"/>
</xf:output>
<xf:upload ref=".">
<xf:filename ref="@filename"/>
<xf:mediatype ref="@mediatype"/>
<idega:dispatch ev:event="xforms-value-changed" name="idega-validate" stopOnError="true" target="//*[@id='fbc_6']//xf:upload"/>
<idega:validator componentId="fbc_6" ev:event="idega-validate" validateif="(.!='' and ./description !='') or (.='' and ./description ='')">
<idega:message errorType="custom" model="data_model" value="instance('localized_strings')/fbc_6-custom[@lang=instance('localized_strings')/current_language]"/>
</idega:validator>
</xf:upload>
<xf:trigger>
<xf:label model="data_model" ref="instance('localized_strings')/fbc_6-remove_trigger-label[@lang=instance('localized_strings')/current_language]"/>
<xf:action>
<xf:delete at="index('fbc_6-multiupload_entries')" nodeset="instance('data-instance')/Attachements_fbc_6/entry"/>
</xf:action>
</xf:trigger>
</xf:group>
</xf:repeat>
</xf:group>
<div class="fbc_button_area" id="fbc_7" type="fbc_button_area">
<xf:trigger bind="bind-submissionButton" class="fbc_button_submit" id="fbc_8" type="fbc_button_submit">
<xf:label model="data_model" ref="instance('localized_strings')/fbc_8-label[@lang=instance('localized_strings')/current_language]"/>
<xf:action ev:event="DOMActivate">
<xf:setvalue ref="instance('control-instance')/submission" value="'true'"/>
<idega:dispatch name="idega-validate" target="//h:body//*[starts-with(@id, 'fbc_')]"/>
<xf:dispatch name="xforms-rebuild" target="data_model"/>
<xf:dispatch name="xforms-recalculate" target="data_model"/>
<xf:dispatch name="xforms-revalidate" target="data_model"/>
<xf:dispatch name="xforms-refresh" target="data_model"/>
<xf:action if="count-non-empty(instance('error-instance')/error)=0">
<xf:send submission="submit_data_submission"/>
</xf:action>
<xf:dispatch if="count-non-empty(instance('error-instance')/error)!=0" name="idega-submit-error" target="idega-submission-error"/>
</xf:action>
</xf:trigger>
</div>
</xf:group>
                  </idega:case>
                  <idega:case id="fbc_4" type="thx_page">
                        <xf:group appearance="full">
                            <xf:label model="data_model" ref="instance('localized_strings')/page-2-label[@lang=instance('localized_strings')/current_language]"/>
                            <xf:output model="data_model" ref="instance('localized_strings')/page-2-info[@lang=instance('localized_strings')/current_language]"/>
                        </xf:group>
                  </idega:case>
            </idega:switch>
        </xf:group>
    </body>
</html>
